# Курсовая работа по дисциплине "Базы данных", осенний семестр 2020

Данная инструкция будет пополняться информацией (но это не точно).

### Содержимое данного репозитория

* `README.md` - файл, который вы сейчас читаете (не редактировать);
* `tz.md` - файл, в который необходимо внести техническое задание на разработку курсовой работы в формате markdown ([шпаргалка](https://github.com/sandino/Markdown-Cheatsheet))
* `.gitignore` - файл, содержащий указания относительно того, какие файлы и папки в рабочем каталоге необходимо игнорировать и не помещать в систему контроля версий; например, туда входят файлы .pyc, папка с виртуальным окружением venv/ и другие. Если вы не знаете, редактировать этот файл или нет, - не редактируйте;
* `run.py` - файл, запускающий веб-приложение;
* `app/` - каталог, в котором содержатся файлы с исходным кодом веб-приложения; структура проекта в каталоге app/ выбирается самостоятельно, но должна быть адекватной;
* `scripts/` - каталог, в котором содержатся sql-скрипты: `create_db.sql` - создание БД, `insert_data.sql` - добавление начальных данных в БД.

При необходимости можно создавать дополнительные файлы или каталоги в корне репозитория, если это оправданно.

## Краткая справка по работе с программой psql (CLI-клиент PostgreSQL)

В случае работы из командной строки Windows имеет смысл сменить кодировку консоли:

`chcp 1251`

Это позволит корректно отображать кириллические символы.

Запуск psql:

`psql -h хост -p порт -d имя_бд -U имя_пользователя -W`

При этом параметры хоста и порта можно опустить, если не изменялись настройки, то будет происходить подключение к локальному серверу к порту 5432.
Если опустить имя пользователя, будет происходить подключение суперпользователем с именем postgres, который создается при установке. Если опустить имя базы данных, то произойдет попытка подключение к базе данных, имеющей то же имя, что и пользователь. Если ее не существует, в соединении будет отказано.

Если произошло подключение, то становятся доступны команды интерактивного режима:

`\du` - вывести список пользователей

`\l` - вывести список баз данных

`\c имя_бд` - сменить текущую базу данных

`\dn` - вывести список схем в текущей базе данных

`\dt` - вывести список таблиц в текущей базе данных

`\d имя_таблицы` - вывести информацию о таблице

`\q` - выйти из интерактивного сеанса psql

## Создание пользователя и БД в PostgreSQL

Для того, чтобы создать базу данных и пользователя, который будет с ней работать, отличного от суперпользователя (postgres), необходимо выполнить следующие шаги.

1. Подключиться к серверу пользователем postgres
1. Выполнить команду `CREATE USER имя_вашего_пользователя WITH PASSWORD 'пароль_вашего_пользователя';`
1. Выполнить команду `CREATE DATABASE имя_вашей_бд;` (если база данных уже создана, выполнять эту команду не надо)
1. Сменить текущую базу данных: `\с имя_вашей_бд`
1. Выполнить команду `GRANT ALL ON DATABASE имя_вашей_бд TO имя_вашего_пользователя;`
1. Выполнить команду `GRANT ALL ON SCHEMA public TO имя_вашего_пользователя;`
1. Выполнить команду `GRANT ALL ON ALL TABLES IN SCHEMA public TO имя_вашего_пользователя;`
1. Выйти из psql

После этого можно проверить внесеннные изменеия, подключившись новым пользователем к созданной базе данных и создав в ней таблицу. 